<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Player Profile</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="/scripts/stored-colors.css">
  <script src="/scripts/accent-loader.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #ffffff;
      color: var(--text-color);
      margin: 0;
      overflow-x: hidden;
    }

    .container {
      padding-top: 30px;
      max-width: 600px;
      margin: auto;
      text-align: center;
    }

    h1, h2 {
      margin: 0;
      opacity: 0;
      transform: translateY(20px);
      animation: popIn 0.6s forwards ease-out;
    }

    h2 {
      font-weight: normal;
      color: var(--text-color);
      font-size: 1.1rem;
      animation-delay: 0.2s;
    }

    .stats-section {
      margin-top: 25px;
    }

    .stat-card {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 12px;
      margin: 12px 0;
      opacity: 0;
      transform: scale(0.85);
      animation: popInScale 0.5s forwards ease-out;
    }

    .stat-card:nth-child(1) { animation-delay: 0.3s; }
    .stat-card:nth-child(2) { animation-delay: 0.45s; }
    .stat-card:nth-child(3) { animation-delay: 0.6s; }
    .stat-card:nth-child(4) { animation-delay: 0.75s; }
    .stat-card:nth-child(5) { animation-delay: 0.9s; }
    .stat-card:nth-child(6) { animation-delay: 1.05s; }

    @keyframes popIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes popInScale {
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
  </style>
</head>
<body>
  <div class="navbar">
    <!-- Logo image that links to index.html -->
    <a href="index.html" class="logo">
      <img src="/images/phLogo.png" alt="Strike Master Logo">
    </a>

    <div class="nav-links">
      <a href="teamSelector.html">Team Selector</a>
      <a href="boysRecords.html">Records</a>
      <a href="boysPlayers.html">Players</a>
      <a href="/settings/appearanceSettings.html">Settings</a>
      <a href="myTeam.html">My Team</a>
    </div>
  </div>

  <div class="container">
    <h1 id="playerName">Loading...</h1>
    <h2 id="playerSpot"></h2>

    <div class="stats-section" id="statsSection"></div>
  </div>

  <script>
    async function loadPlayer() {
      // Get ?name= from URL
      const params = new URLSearchParams(window.location.search);
      const name = params.get("name");

      if (!name) {
        document.getElementById("playerName").textContent = "Player Not Found";
        return;
      }

      try {
        const res = await fetch(`http://127.0.0.1:5000/api/players/${encodeURIComponent(name)}`);
        if (!res.ok) throw new Error();

        const player = await res.json();

        // Populate page
        document.getElementById("playerName").textContent = player.name;
        document.getElementById("playerSpot").textContent = `Spot #${player.spot}`;

        const stats = [
          { label: "Season Average", value: player.seasonAverage },
          { label: "Total Strikes", value: player.totalStrikes },
          { label: "Total Spares", value: player.totalSpares },
          { label: "Game 1 Average", value: player.gameAverages["1"] },
          { label: "Game 2 Average", value: player.gameAverages["2"] },
          { label: "Game 3 Average", value: player.gameAverages["3"] }
        ];

        const statsSection = document.getElementById("statsSection");

        stats.forEach(s => {
          const div = document.createElement("div");
          div.className = "stat-card";
          div.innerHTML = `
            <h3>${s.label}</h3>
            <p style="font-size: 1.4rem; margin-top: 6px;">${s.value}</p>
          `;
          statsSection.appendChild(div);
        });

      } catch (err) {
        document.getElementById("playerName").textContent = "Error Loading Player";
      }
    }

    loadPlayer();
  </script>
</body>
</html>
